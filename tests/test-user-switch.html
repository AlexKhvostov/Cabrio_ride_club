<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÑ –¢–µ—Å—Ç —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è CabrioRide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #00ff88, #00ccff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .test-section h3 {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .test-section p {
            color: #ccc;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .user-info {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .user-info h4 {
            color: #00ff88;
            margin-bottom: 10px;
        }
        
        .user-detail {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .user-detail:last-child {
            border-bottom: none;
        }
        
        .user-detail .label {
            color: #888;
            font-weight: 500;
        }
        
        .user-detail .value {
            color: #fff;
            font-weight: 600;
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .test-btn {
            background: linear-gradient(135deg, #0077cc, #0055aa);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }
        
        .test-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 119, 204, 0.3);
        }
        
        .test-btn.success {
            background: linear-gradient(135deg, #00ff88, #00cc66);
        }
        
        .test-btn.warning {
            background: linear-gradient(135deg, #ffaa00, #cc8800);
        }
        
        .test-btn.danger {
            background: linear-gradient(135deg, #ff3366, #cc2244);
        }
        
        .log-section {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .log-section h4 {
            color: #00ff88;
            margin-bottom: 15px;
        }
        
        .log-content {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            color: #ccc;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .clear-log {
            background: #ff3366;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 0.8rem;
        }
        
        .clear-log:hover {
            background: #cc2244;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-indicator.success {
            background: #00ff88;
        }
        
        .status-indicator.error {
            background: #ff3366;
        }
        
        .status-indicator.warning {
            background: #ffaa00;
        }
        
        @media (max-width: 768px) {
            .test-buttons {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ –¢–µ—Å—Ç —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
            <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏ —Å–º–µ–Ω–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ Telegram</p>
        </div>

        <!-- –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å -->
        <div class="test-section">
            <h3>üë§ –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>
            <div class="user-info" id="current-user-info">
                <h4>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...</h4>
            </div>
            <div class="test-buttons">
                <button class="test-btn" onclick="checkCurrentUser()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                <button class="test-btn warning" onclick="clearUserData()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                <button class="test-btn danger" onclick="forceReload()">üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞</button>
            </div>
        </div>

        <!-- –¢–µ—Å—Ç —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div class="test-section">
            <h3>üîÑ –¢–µ—Å—Ç —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
            <p>–°–∏–º—É–ª—è—Ü–∏—è —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>
            
            <div class="test-buttons">
                <button class="test-btn" onclick="simulateUserSwitch()">üîÑ –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                <button class="test-btn warning" onclick="testDifferentUsers()">üë• –¢–µ—Å—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
                <button class="test-btn" onclick="testAuthFlow()">üîê –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</button>
            </div>
        </div>

        <!-- –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage -->
        <div class="test-section">
            <h3>üíæ –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage</h3>
            <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –±—Ä–∞—É–∑–µ—Ä–µ</p>
            
            <div class="user-info" id="localstorage-info">
                <h4>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö localStorage...</h4>
            </div>
            
            <div class="test-buttons">
                <button class="test-btn" onclick="checkLocalStorage()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å localStorage</button>
                <button class="test-btn warning" onclick="clearLocalStorage()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å localStorage</button>
                <button class="test-btn" onclick="exportUserData()">üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
            </div>
        </div>

        <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
        <div class="test-section">
            <h3>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</h3>
            <div class="user-info">
                <h4>–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</h4>
                <ol style="color: #ccc; line-height: 1.8; padding-left: 20px;">
                    <li><strong>–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å</strong> –ø–æ–¥ –ø–µ—Ä–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —á–µ—Ä–µ–∑ Telegram</li>
                    <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ</strong> —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</li>
                    <li><strong>–í Telegram</strong> —Å–º–µ–Ω–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ –¥—Ä—É–≥–æ–π</li>
                    <li><strong>–ù–∞ —Å–∞–π—Ç–µ</strong> –Ω–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram"</li>
                    <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ</strong> —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å –Ω–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</li>
                    <li><strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏</strong> –Ω–∏–∂–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</li>
                </ol>
            </div>
        </div>

        <!-- –õ–æ–≥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
        <div class="log-section">
            <h4>üìù –õ–æ–≥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h4>
            <div class="log-content" id="test-log">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤—ã—à–µ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...</div>
            <button class="clear-log" onclick="clearLog()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let testLog = [];
        
        // –§—É–Ω–∫—Ü–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}`;
            testLog.push(logEntry);
            updateLogDisplay();
            console.log(logEntry);
        }
        
        function updateLogDisplay() {
            const logElement = document.getElementById('test-log');
            logElement.textContent = testLog.join('\n');
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        function clearLog() {
            testLog = [];
            updateLogDisplay();
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function checkCurrentUser() {
            log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage
                const storedUser = localStorage.getItem('cabrioride_user');
                const authTimestamp = localStorage.getItem('auth_timestamp');
                const currentUserId = localStorage.getItem('current_user_id');
                
                const userInfoElement = document.getElementById('current-user-info');
                
                if (storedUser) {
                    const user = JSON.parse(storedUser);
                    const authTime = authTimestamp ? new Date(parseInt(authTimestamp)).toLocaleString() : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
                    
                    userInfoElement.innerHTML = `
                        <h4><span class="status-indicator success"></span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω</h4>
                        <div class="user-detail">
                            <span class="label">ID:</span>
                            <span class="value">${user.id}</span>
                        </div>
                        <div class="user-detail">
                            <span class="label">–ò–º—è:</span>
                            <span class="value">${user.first_name} ${user.last_name || ''}</span>
                        </div>
                        <div class="user-detail">
                            <span class="label">Username:</span>
                            <span class="value">@${user.username || '–Ω–µ —É–∫–∞–∑–∞–Ω'}</span>
                        </div>
                        <div class="user-detail">
                            <span class="label">–í—Ä–µ–º—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:</span>
                            <span class="value">${authTime}</span>
                        </div>
                        <div class="user-detail">
                            <span class="label">–¢–µ–∫—É—â–∏–π ID:</span>
                            <span class="value">${currentUserId || '–Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω'}</span>
                        </div>
                    `;
                    
                    log(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.first_name} (ID: ${user.id})`);
                } else {
                    userInfoElement.innerHTML = `
                        <h4><span class="status-indicator error"></span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω</h4>
                        <p>–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ localStorage</p>
                    `;
                    log('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${error.message}`, 'error');
            }
        }
        
        // –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function clearUserData() {
            log('üßπ –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
            
            try {
                const keysToRemove = [
                    'cabrioride_user',
                    'telegram_user',
                    'auth_token',
                    'auth_method',
                    'user_verified',
                    'auth_fallback',
                    'auth_timestamp',
                    'current_user_id',
                    'telegram_auth_data',
                    'user_session',
                    'app_state'
                ];
                
                keysToRemove.forEach(key => {
                    if (localStorage.getItem(key)) {
                        localStorage.removeItem(key);
                        log(`üóëÔ∏è –£–¥–∞–ª–µ–Ω –∫–ª—é—á: ${key}`);
                    }
                });
                
                sessionStorage.clear();
                log('üóëÔ∏è SessionStorage –æ—á–∏—â–µ–Ω');
                
                log('‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—á–∏—â–µ–Ω—ã');
                checkCurrentUser();
                checkLocalStorage();
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ: ${error.message}`, 'error');
            }
        }
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
        function forceReload() {
            log('üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã...');
            setTimeout(() => {
                window.location.reload(true);
            }, 1000);
        }
        
        // –°–∏–º—É–ª—è—Ü–∏—è —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function simulateUserSwitch() {
            log('üîÑ –°–∏–º—É–ª—è—Ü–∏—è —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
            
            try {
                const oldUser = localStorage.getItem('cabrioride_user');
                if (oldUser) {
                    const user = JSON.parse(oldUser);
                    log(`üìã –°—Ç–∞—Ä—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.first_name} (ID: ${user.id})`);
                }
                
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const newUser = {
                    id: Math.floor(Math.random() * 1000000000),
                    first_name: '–ù–æ–≤—ã–π',
                    last_name: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    username: 'newuser' + Math.floor(Math.random() * 1000),
                    photo_url: null,
                    auth_date: Math.floor(Date.now() / 1000)
                };
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                localStorage.setItem('cabrioride_user', JSON.stringify(newUser));
                localStorage.setItem('auth_timestamp', Date.now().toString());
                localStorage.setItem('current_user_id', newUser.id.toString());
                localStorage.setItem('auth_method', 'telegram_widget');
                localStorage.setItem('user_verified', 'true');
                
                log(`‚úÖ –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω: ${newUser.first_name} (ID: ${newUser.id})`);
                log('üîÑ –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç');
                
                checkCurrentUser();
                checkLocalStorage();
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∏–º—É–ª—è—Ü–∏–∏: ${error.message}`, 'error');
            }
        }
        
        // –¢–µ—Å—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function testDifferentUsers() {
            log('üë• –¢–µ—Å—Ç —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...');
            
            const testUsers = [
                {
                    id: 123456789,
                    first_name: '–ê–ª–µ–∫—Å–µ–π',
                    last_name: '–ü–µ—Ç—Ä–æ–≤',
                    username: 'alex_petrov'
                },
                {
                    id: 987654321,
                    first_name: '–ú–∞—Ä–∏—è',
                    last_name: '–ò–≤–∞–Ω–æ–≤–∞',
                    username: 'maria_ivanova'
                },
                {
                    id: 555666777,
                    first_name: '–î–º–∏—Ç—Ä–∏–π',
                    last_name: '–°–∏–¥–æ—Ä–æ–≤',
                    username: 'dmitry_sidorov'
                }
            ];
            
            testUsers.forEach((user, index) => {
                setTimeout(() => {
                    log(`üîÑ –¢–µ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${index + 1}: ${user.first_name} (ID: ${user.id})`);
                    
                    localStorage.setItem('cabrioride_user', JSON.stringify(user));
                    localStorage.setItem('auth_timestamp', Date.now().toString());
                    localStorage.setItem('current_user_id', user.id.toString());
                    
                    checkCurrentUser();
                }, index * 2000);
            });
        }
        
        // –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function testAuthFlow() {
            log('üîê –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏...');
            
            // –®–∞–≥ 1: –û—á–∏—Å—Ç–∫–∞
            log('1Ô∏è‚É£ –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ...');
            clearUserData();
            
            setTimeout(() => {
                // –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                log('2Ô∏è‚É£ –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
                const testUser = {
                    id: 999888777,
                    first_name: '–¢–µ—Å—Ç–æ–≤—ã–π',
                    last_name: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                    username: 'test_user',
                    photo_url: null,
                    auth_date: Math.floor(Date.now() / 1000)
                };
                
                localStorage.setItem('cabrioride_user', JSON.stringify(testUser));
                localStorage.setItem('auth_timestamp', Date.now().toString());
                localStorage.setItem('current_user_id', testUser.id.toString());
                localStorage.setItem('auth_method', 'telegram_widget');
                localStorage.setItem('user_verified', 'true');
                
                log(`‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω: ${testUser.first_name}`);
                
                setTimeout(() => {
                    // –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞
                    log('3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç...');
                    checkCurrentUser();
                    checkLocalStorage();
                    
                    log('‚úÖ –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∑–∞–≤–µ—Ä—à–µ–Ω');
                }, 1000);
            }, 1000);
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage
        function checkLocalStorage() {
            log('üíæ –ü—Ä–æ–≤–µ—Ä–∫–∞ localStorage...');
            
            try {
                const relevantKeys = [
                    'cabrioride_user',
                    'auth_timestamp',
                    'current_user_id',
                    'auth_method',
                    'user_verified',
                    'auth_token',
                    'telegram_user'
                ];
                
                const storageInfo = {};
                
                relevantKeys.forEach(key => {
                    const value = localStorage.getItem(key);
                    if (value) {
                        storageInfo[key] = value.length > 100 ? value.substring(0, 100) + '...' : value;
                    }
                });
                
                const storageElement = document.getElementById('localstorage-info');
                
                if (Object.keys(storageInfo).length > 0) {
                    let html = '<h4><span class="status-indicator success"></span>–î–∞–Ω–Ω—ã–µ –Ω–∞–π–¥–µ–Ω—ã</h4>';
                    
                    Object.entries(storageInfo).forEach(([key, value]) => {
                        html += `
                            <div class="user-detail">
                                <span class="label">${key}:</span>
                                <span class="value">${value}</span>
                            </div>
                        `;
                    });
                    
                    storageElement.innerHTML = html;
                    log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ ${Object.keys(storageInfo).length} –∫–ª—é—á–µ–π –≤ localStorage`);
                } else {
                    storageElement.innerHTML = `
                        <h4><span class="status-indicator error"></span>–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h4>
                        <p>localStorage –ø—É—Å—Ç –∏–ª–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</p>
                    `;
                    log('‚ùå –î–∞–Ω–Ω—ã–µ –≤ localStorage –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ localStorage: ${error.message}`, 'error');
            }
        }
        
        // –û—á–∏—Å—Ç–∫–∞ localStorage
        function clearLocalStorage() {
            log('üóëÔ∏è –û—á–∏—Å—Ç–∫–∞ localStorage...');
            
            try {
                localStorage.clear();
                log('‚úÖ localStorage –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–µ–Ω');
                checkLocalStorage();
                checkCurrentUser();
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ localStorage: ${error.message}`, 'error');
            }
        }
        
        // –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function exportUserData() {
            log('üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
            
            try {
                const userData = {
                    timestamp: new Date().toISOString(),
                    localStorage: {},
                    sessionStorage: {}
                };
                
                // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ localStorage
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key) {
                        userData.localStorage[key] = localStorage.getItem(key);
                    }
                }
                
                // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ sessionStorage
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    if (key) {
                        userData.sessionStorage[key] = sessionStorage.getItem(key);
                    }
                }
                
                const dataStr = JSON.stringify(userData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                
                const link = document.createElement('a');
                link.href = url;
                link.download = `user-data-${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.json`;
                link.click();
                
                URL.revokeObjectURL(url);
                
                log('‚úÖ –î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–∞–π–ª');
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: ${error.message}`, 'error');
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞ —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
            checkCurrentUser();
            checkLocalStorage();
        });
    </script>
</body>
</html> 